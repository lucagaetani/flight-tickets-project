{
  "version": 3,
  "sources": ["../../../src/dialects/ibmi/query-interface.js"],
  "sourcesContent": ["'use strict';\n\nconst { Transaction } = require('../../transaction');\nconst { AbstractQueryInterface } = require('../abstract/query-interface');\n\n/**\n Returns an object that enables the `ibmi` dialect to call underlying odbc\n transaction functions through the connection methods instead\n\n @class QueryInterface\n @static\n @private\n */\n\nexport class IBMiQueryInterface extends AbstractQueryInterface {\n\n  startTransaction(transaction, options) {\n    if (!(transaction instanceof Transaction)) {\n      throw new TypeError('Unable to start a transaction without transaction object!');\n    }\n\n    options = { ...options, transaction: transaction.parent || transaction };\n\n    options.transaction.name = transaction.parent ? transaction.name : undefined;\n\n    return transaction.getConnection().beginTransaction();\n  }\n\n  commitTransaction(transaction) {\n    if (!(transaction instanceof Transaction)) {\n      throw new TypeError('Unable to commit a transaction without transaction object!');\n    }\n\n    if (transaction.parent) {\n      throw new Error('Unable to commit a transaction that has a parent transaction!');\n    }\n\n    const promise = transaction.getConnection().commit();\n    transaction.finished = 'commit';\n\n    return promise;\n  }\n\n  rollbackTransaction(transaction, options) {\n    if (!(transaction instanceof Transaction)) {\n      throw new TypeError('Unable to rollback a transaction without transaction object!');\n    }\n\n    options = {\n      ...options,\n      transaction: transaction.parent || transaction,\n      supportsSearchPath: false,\n      completesTransaction: true,\n    };\n    options.transaction.name = transaction.parent ? transaction.name : undefined;\n\n    const promise = transaction.getConnection().rollback();\n    transaction.finished = 'commit';\n\n    return promise;\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,MAAM,EAAE,YAAY,IAAI,QAAQ,mBAAmB;AACnD,MAAM,EAAE,uBAAuB,IAAI,QAAQ,6BAA6B;AAWjE,MAAM,2BAA2B,uBAAuB;AAAA,EAE7D,iBAAiB,aAAa,SAAS;AACrC,QAAI,EAAE,uBAAuB,cAAc;AACzC,YAAM,IAAI,UAAU,2DAA2D;AAAA,IACjF;AAEA,cAAU,EAAE,GAAG,SAAS,aAAa,YAAY,UAAU,YAAY;AAEvE,YAAQ,YAAY,OAAO,YAAY,SAAS,YAAY,OAAO;AAEnE,WAAO,YAAY,cAAc,EAAE,iBAAiB;AAAA,EACtD;AAAA,EAEA,kBAAkB,aAAa;AAC7B,QAAI,EAAE,uBAAuB,cAAc;AACzC,YAAM,IAAI,UAAU,4DAA4D;AAAA,IAClF;AAEA,QAAI,YAAY,QAAQ;AACtB,YAAM,IAAI,MAAM,+DAA+D;AAAA,IACjF;AAEA,UAAM,UAAU,YAAY,cAAc,EAAE,OAAO;AACnD,gBAAY,WAAW;AAEvB,WAAO;AAAA,EACT;AAAA,EAEA,oBAAoB,aAAa,SAAS;AACxC,QAAI,EAAE,uBAAuB,cAAc;AACzC,YAAM,IAAI,UAAU,8DAA8D;AAAA,IACpF;AAEA,cAAU;AAAA,MACR,GAAG;AAAA,MACH,aAAa,YAAY,UAAU;AAAA,MACnC,oBAAoB;AAAA,MACpB,sBAAsB;AAAA,IACxB;AACA,YAAQ,YAAY,OAAO,YAAY,SAAS,YAAY,OAAO;AAEnE,UAAM,UAAU,YAAY,cAAc,EAAE,SAAS;AACrD,gBAAY,WAAW;AAEvB,WAAO;AAAA,EACT;AACF;",
  "names": []
}
